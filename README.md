# 推荐系统数据降维

表1 菜品打分数据表
	叉烧肠粉	新疆手抓饭	四川火锅	粤式烧鹅饭	大盘鸡拌面	东北饺子	重庆辣子鸡	广东虾饺	剁椒鱼头	兰州拉面	烤羊排
丁一	5	2	1	4	0	0	2	4	0	0	0
刘二	0	0	0	0	0	0	0	0	0	3	0
张三	1	0	5	2	0	0	3	0	3	0	1
李四	0	5	0	0	4	0	1	0	0	0	0
王五	0	0	0	0	0	4	0	0	0	4	0
马六	0	0	1	0	0	0	1	0	0	5	0
陈七	5	0	2	4	2	1	0	3	0	1	0
胡八	0	4	0	0	5	4	0	0	0	0	5
赵九	0	0	0	0	0	0	4	0	4	5	0
钱十	0	0	0	4	0	0	1	5	0	0	0
孙甲	0	0	0	0	4	5	0	0	0	0	3
周乙	4	2	1	4	0	0	2	4	0	0	0
吴丙	0	1	4	1	2	1	5	0	5	0	0
郑丁	0	0	0	0	0	4	0	0	0	4	0
冯戊	2	5	0	0	4	0	0	0	0	0	0
褚己	5	0	0	0	0	0	0	4	2	0	0
魏庚	0	2	4	0	4	3	4	0	0	0	0
高辛	0	3	5	1	0	0	4	1	0	0	0


如表1所示为18名用户对11个不同的菜品进行了打分评价表，打分为0表示用户未消费该类菜品。\<br>  

本次建模的目标是根据用户对菜品的1-5打分，来分析用户对打分为0的菜品的可能打分，来进行菜品推荐。
例如我们想给丁一推荐菜品，已知丁一没吃过的菜品有大盘面拌鸡，东北饺子，剁椒鱼头，兰州拉面，烤羊排，目标是根据丁一对已经吃过的菜品从中进行推荐。同理对其他顾客进行菜品推荐。
为了进行菜品推荐，就要寻找不同菜品之间的相似程度，相似度高的菜品，打分也是相似的，就能判断出顾客对菜品的喜爱程度从而进行推荐。
相似度采用余弦相似度来计算：
公式为：
代码为：
def cosSim(vec_1, vec_2):
    dotProd = float(np.dot(vec_1.T, vec_2))
    normProd = np.linalg.norm(vec_1)*np.linalg.norm(vec_2)
    return 0.5+0.5*(dotProd/normProd)
    
计算菜品的余弦相似度需要同时吃过该菜品的顾客的打分，因此需要对该菜品打分的稀疏矩阵进行主成分分析来降维。计算得得到特征值后：进行累计贡献率计算，取累计贡献率大于90%作为主成分分析，代码为：

for k in range(len(eignvalue)):
    sigmaSum = sigmaSum + eignvalue[k]
    if float(sigmaSum)/float(np.sum(eignvalue)) > 0.9:
        k_num = k+1
        Break
	
可得需要前6个特征值，即把维度降到6维。
用主成分分析的方法得到6*11维的矩阵scoreData_PCA。
代码为：
pca = decomposition.PCA(n_components=k_num)
scoreData_PCA = pca.fit_transform(scoreData_mean).T
最后进行相似度加权打分，计算公式为：

得到最终结果为：
丁一,大盘鸡拌面,score:2.79
丁一,东北饺子,score:2.67
丁一,剁椒鱼头,score:2.57
丁一,兰州拉面,score:3.06
丁一,烤羊排,score:3.18
刘二,叉烧肠粉,score:3.0
刘二,新疆手抓饭,score:3.0
刘二,四川火锅,score:3.0
刘二,粤式烧鹅饭,score:3.0
刘二,大盘鸡拌面,score:3.0
刘二,东北饺子,score:3.0
刘二,重庆辣子鸡,score:3.0
刘二,广东虾饺,score:3.0
刘二,剁椒鱼头,score:3.0
刘二,烤羊排,score:3.0
张三,新疆手抓饭,score:2.47
张三,大盘鸡拌面,score:2.39
张三,东北饺子,score:2.66
张三,广东虾饺,score:2.067
张三,兰州拉面,score:2.43
李四,叉烧肠粉,score:2.29
李四,四川火锅,score:2.91
李四,粤式烧鹅饭,score:3.64
李四,东北饺子,score:4.028
李四,广东虾饺,score:3.46
李四,剁椒鱼头,score:4.05
李四,兰州拉面,score:2.98
李四,烤羊排,score:3.51
王五,叉烧肠粉,score:4.0
王五,新疆手抓饭,score:4.0
王五,四川火锅,score:4.0
王五,粤式烧鹅饭,score:4.0
王五,大盘鸡拌面,score:4.0
王五,重庆辣子鸡,score:4.0
王五,广东虾饺,score:4.0
王五,剁椒鱼头,score:4.0
王五,烤羊排,score:4.0
马六,叉烧肠粉,score:2.43
马六,新疆手抓饭,score:2.78
马六,粤式烧鹅饭,score:2.52
马六,大盘鸡拌面,score:2.49
马六,东北饺子,score:2.48
马六,广东虾饺,score:2.42
马六,剁椒鱼头,score:2.26
马六,烤羊排,score:2.35
陈七,新疆手抓饭,score:2.20
陈七,重庆辣子鸡,score:2.79
陈七,剁椒鱼头,score:2.17
陈七,烤羊排,score:2.58
胡八,叉烧肠粉,score:4.43
胡八,四川火锅,score:4.46
胡八,粤式烧鹅饭,score:4.52
胡八,重庆辣子鸡,score:4.55
胡八,广东虾饺,score:4.69
胡八,剁椒鱼头,score:4.38
胡八,兰州拉面,score:4.45
赵九,叉烧肠粉,score:4.40
赵九,新疆手抓饭,score:4.30
赵九,四川火锅,score:4.29
赵九,粤式烧鹅饭,score:4.34
赵九,大盘鸡拌面,score:4.28
赵九,东北饺子,score:4.27
赵九,广东虾饺,score:4.35
赵九,烤羊排,score:4.32
钱十,叉烧肠粉,score:2.40
钱十,新疆手抓饭,score:3.48
钱十,四川火锅,score:2.83
钱十,大盘鸡拌面,score:3.54
钱十,东北饺子,score:3.37
钱十,剁椒鱼头,score:3.51
钱十,兰州拉面,score:2.71
钱十,烤羊排,score:3.85
孙甲,叉烧肠粉,score:4.06
孙甲,新疆手抓饭,score:4.22
孙甲,四川火锅,score:4.11
孙甲,粤式烧鹅饭,score:3.87
孙甲,重庆辣子鸡,score:3.91
孙甲,广东虾饺,score:3.64
孙甲,剁椒鱼头,score:4.27
孙甲,兰州拉面,score:4.06
周乙,大盘鸡拌面,score:2.71
周乙,东北饺子,score:2.57
周乙,剁椒鱼头,score:2.49
周乙,兰州拉面,score:2.80
周乙,烤羊排,score:3.1
吴丙,叉烧肠粉,score:3.27
吴丙,广东虾饺,score:2.32
吴丙,兰州拉面,score:2.93
吴丙,烤羊排,score:2.46
郑丁,叉烧肠粉,score:4.0
郑丁,新疆手抓饭,score:4.0
郑丁,四川火锅,score:4.0
郑丁,粤式烧鹅饭,score:4.0
郑丁,大盘鸡拌面,score:4.0
郑丁,重庆辣子鸡,score:4.0
郑丁,广东虾饺,score:4.0
郑丁,剁椒鱼头,score:4.0
郑丁,烤羊排,score:4.0
冯戊,四川火锅,score:3.31
冯戊,粤式烧鹅饭,score:3.74
冯戊,东北饺子,score:4.19
冯戊,重庆辣子鸡,score:3.05
冯戊,广东虾饺,score:3.85
冯戊,剁椒鱼头,score:4.13
冯戊,兰州拉面,score:3.33
冯戊,烤羊排,score:3.98
褚己,新疆手抓饭,score:3.13
褚己,四川火锅,score:3.46
褚己,粤式烧鹅饭,score:3.77
褚己,大盘鸡拌面,score:3.22
褚己,东北饺子,score:3.02
褚己,重庆辣子鸡,score:4.31
褚己,兰州拉面,score:4.0
褚己,烤羊排,score:3.7
魏庚,叉烧肠粉,score:3.6
魏庚,粤式烧鹅饭,score:3.26
魏庚,广东虾饺,score:3.43
魏庚,剁椒鱼头,score:3.24
魏庚,兰州拉面,score:3.43
魏庚,烤羊排,score:3.43
高辛,叉烧肠粉,score:3.28
高辛,大盘鸡拌面,score:2.67
高辛,东北饺子,score:2.91
高辛,剁椒鱼头,score:3.11
高辛,兰州拉面,score:3.11
高辛,烤羊排,score:2.25
